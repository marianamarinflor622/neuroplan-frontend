/* Accessibility Styles */

/* Variables CSS personalizadas */
:root {
  --accessibility-font-size: 100%;
  --accessibility-letter-spacing: 0px;
  --accessibility-line-height: 150%;
  --accessibility-word-spacing: 0px;
  --accessibility-contrast: 100%;
  --accessibility-saturation: 100%;
  --accessibility-brightness: 100%;
}

/* Aplicar variables a todo el contenido */
body {
  font-size: var(--accessibility-font-size);
  letter-spacing: var(--accessibility-letter-spacing);
  line-height: var(--accessibility-line-height);
  word-spacing: var(--accessibility-word-spacing);
}

/* Filtros base de color (se combinan) */
body:not([class*="accessibility-colorblind-"]):not(.accessibility-monochrome):not(.accessibility-inverted-contrast) {
  filter: contrast(var(--accessibility-contrast)) 
          saturate(var(--accessibility-saturation)) 
          brightness(var(--accessibility-brightness));
}

/* Cursor Negro */
.accessibility-cursor-black,
.accessibility-cursor-black * {
  cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><circle cx="16" cy="16" r="10" fill="black"/></svg>') 16 16, auto !important;
}

/* Cursor Blanco */
.accessibility-cursor-white,
.accessibility-cursor-white * {
  cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><circle cx="16" cy="16" r="10" fill="white" stroke="black" stroke-width="2"/></svg>') 16 16, auto !important;
}

/* Guía de Lectura */
.accessibility-reading-guide::before {
  content: '';
  position: fixed;
  top: 50%;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, transparent, #ff6b6b 20%, #ff6b6b 80%, transparent);
  pointer-events: none;
  z-index: 9999;
  animation: reading-guide-pulse 2s ease-in-out infinite;
}

@keyframes reading-guide-pulse {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

/* Alineación de texto */
.accessibility-text-left * {
  text-align: left !important;
}

.accessibility-text-center * {
  text-align: center !important;
}

.accessibility-text-right * {
  text-align: right !important;
}

.accessibility-text-justify * {
  text-align: justify !important;
}

/* Bloquear parpadeos */
.accessibility-block-flashing * {
  animation: none !important;
  transition: none !important;
}

.accessibility-block-flashing *::before,
.accessibility-block-flashing *::after {
  animation: none !important;
  transition: none !important;
}

/* Modo Enfoque */
.accessibility-focus-mode *:not(:hover):not(:focus) {
  opacity: 0.5;
  filter: blur(2px);
  transition: opacity 0.3s, filter 0.3s;
}

.accessibility-focus-mode *:hover,
.accessibility-focus-mode *:focus {
  opacity: 1 !important;
  filter: blur(0) !important;
}

/* Fuente Dislexia (OpenDyslexic alternative) */
.accessibility-dyslexia-font * {
  font-family: 'Comic Sans MS', 'Trebuchet MS', Arial, sans-serif !important;
  font-weight: 600 !important;
}

/* Fuente Legible */
.accessibility-readable-font * {
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
}

/* Lectura Fácil (resalta primeras letras) */
.accessibility-easy-reading p,
.accessibility-easy-reading span,
.accessibility-easy-reading div {
  font-feature-settings: "smcp" 1;
}

/* Modo Lectura */
.accessibility-reading-mode {
  background: #f5f5f5 !important;
}

.accessibility-reading-mode nav,
.accessibility-reading-mode aside,
.accessibility-reading-mode footer,
.accessibility-reading-mode header > *:not(h1):not(h2):not(h3) {
  display: none !important;
}

.accessibility-reading-mode main,
.accessibility-reading-mode article {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
  background: white;
  line-height: 1.8;
  font-size: 1.1rem;
}

/* Ocultar Imágenes */
.accessibility-hide-images img,
.accessibility-hide-images picture,
.accessibility-hide-images svg:not(.lucide) {
  display: none !important;
}

/* Resaltar Enlaces */
.accessibility-highlight-links a {
  outline: 3px solid #ffd700 !important;
  outline-offset: 2px;
  background: rgba(255, 215, 0, 0.1) !important;
  text-decoration: underline !important;
}

/* Resaltar Títulos */
.accessibility-highlight-titles h1,
.accessibility-highlight-titles h2,
.accessibility-highlight-titles h3,
.accessibility-highlight-titles h4,
.accessibility-highlight-titles h5,
.accessibility-highlight-titles h6 {
  outline: 3px solid #4CAF50 !important;
  outline-offset: 2px;
  background: rgba(76, 175, 80, 0.1) !important;
  padding: 0.5rem !important;
}

/* Silenciar Sonidos */
.accessibility-mute-sounds video,
.accessibility-mute-sounds audio {
  /* Mute sounds for accessibility */
  opacity: 0.1;
}

/* Brillo Alto - usa backdrop-filter para no sobrescribir otros filtros */
.accessibility-high-brightness::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: brightness(130%);
  backdrop-filter: brightness(130%);
}

/* Brillo Bajo */
.accessibility-low-brightness::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: brightness(70%);
  backdrop-filter: brightness(70%);
}

/* Contraste Alto */
.accessibility-high-contrast::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: contrast(150%);
  backdrop-filter: contrast(150%);
}

.accessibility-high-contrast * {
  font-weight: 600 !important;
}

/* Contraste Claro */
.accessibility-light-contrast {
  background: white !important;
  color: black !important;
}

.accessibility-light-contrast * {
  background: white !important;
  color: black !important;
  border-color: black !important;
}

/* Contraste Invertido */
.accessibility-inverted-contrast::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: invert(1);
  backdrop-filter: invert(1);
}

/* Contraste Oscuro */
.accessibility-dark-contrast {
  background: #121212 !important;
  color: white !important;
}

.accessibility-dark-contrast * {
  background: #121212 !important;
  color: white !important;
  border-color: white !important;
}

/* Monocromo */
.accessibility-monochrome::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: grayscale(100%);
  backdrop-filter: grayscale(100%);
}

/* Saturación Alta */
.accessibility-high-saturation::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: saturate(200%);
  backdrop-filter: saturate(200%);
}

/* Saturación Baja */
.accessibility-low-saturation::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: saturate(50%);
  backdrop-filter: saturate(50%);
}

/* Filtros de Daltonismo */

/* Deuteranopia (dificultad verde-rojo) */
.accessibility-colorblind-deuteranopia::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: contrast(1.2) sepia(0.1) hue-rotate(10deg);
  backdrop-filter: contrast(1.2) sepia(0.1) hue-rotate(10deg);
}

/* Deuteranomalía */
.accessibility-colorblind-deuteranomalía::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: contrast(1.1) sepia(0.05) hue-rotate(5deg);
  backdrop-filter: contrast(1.1) sepia(0.05) hue-rotate(5deg);
}

/* Protanopia (dificultad rojo) */
.accessibility-colorblind-protanopia::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: contrast(1.2) sepia(0.15) hue-rotate(-10deg);
  backdrop-filter: contrast(1.2) sepia(0.15) hue-rotate(-10deg);
}

/* Tritanopia (dificultad azul-amarillo) */
.accessibility-colorblind-tritanopia::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: contrast(1.15) hue-rotate(180deg) saturate(0.8);
  backdrop-filter: contrast(1.15) hue-rotate(180deg) saturate(0.8);
}

/* Tritanomalía */
.accessibility-colorblind-tritanomalía::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: contrast(1.1) hue-rotate(90deg) saturate(0.9);
  backdrop-filter: contrast(1.1) hue-rotate(90deg) saturate(0.9);
}

/* Acromatopsia (sin color) */
.accessibility-colorblind-acromatopsia::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  -webkit-backdrop-filter: grayscale(100%) contrast(1.2);
  backdrop-filter: grayscale(100%) contrast(1.2);
}

/* Lupa (amplificación al hover) - solo en texto y elementos específicos */
.accessibility-magnifier p:hover,
.accessibility-magnifier span:hover,
.accessibility-magnifier a:hover,
.accessibility-magnifier button:hover,
.accessibility-magnifier li:hover,
.accessibility-magnifier h1:hover,
.accessibility-magnifier h2:hover,
.accessibility-magnifier h3:hover,
.accessibility-magnifier h4:hover,
.accessibility-magnifier h5:hover,
.accessibility-magnifier h6:hover {
  transform: scale(1.2) !important;
  z-index: 100;
  position: relative;
  background: white;
  padding: 0.25rem;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  transition: transform 0.2s;
}

/* Excluir elementos del panel de accesibilidad de la lupa */
.accessibility-magnifier .accessibility-panel *:hover,
.accessibility-magnifier .accessibility-trigger:hover {
  transform: none !important;
  z-index: auto;
  box-shadow: none;
}

/* Transiciones suaves para cambios de accesibilidad */
body * {
  transition: filter 0.3s ease, opacity 0.3s ease;
}

/* Asegurar que los controles de accesibilidad siempre sean visibles y no afectados por filtros */
.accessibility-panel,
.accessibility-trigger,
[role="dialog"],
[aria-label*="accesibilidad"],
button[aria-label*="Abrir panel"] {
  filter: none !important;
  opacity: 1 !important;
  z-index: 9999 !important;
  position: relative;
}

/* Excluir panel y trigger de todos los pseudo-elementos de filtro */
.accessibility-panel::before,
.accessibility-trigger::before,
button[aria-label*="Abrir panel"]::before {
  display: none !important;
}

/* Asegurar que el botón flotante siempre sea visible */
button[aria-label="Abrir panel de accesibilidad"] {
  position: fixed !important;
  bottom: 1.5rem !important;
  right: 1.5rem !important;
  z-index: 99999 !important;
  transform: translateZ(0) !important;
  will-change: transform !important;
}

/* Forzar que el botón sea flotante y visible */
button[aria-label="Abrir panel de accesibilidad"],
button[aria-label="Abrir panel de accesibilidad"] * {
  pointer-events: auto !important;
}
